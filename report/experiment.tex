%===================================== CHAP 4 =================================

\chapter{Experiment planning and results}


\section{Experiment plans}
\label{sec:experiment_plan}

In this section we list the set of experiments we have performed in order to answer the research questions as stated in Section \ref{sec:problem_statement}.


\section{Results}

This section gives the results of the experiments listed in Section \ref{sec:experiment_plan}, which are analysed further in Chapter \ref{ch:analysis}.

%output of various basic experiments intended to answers RQs
\begin{table}[h]
	\begin{tabular}{ll}
		\begin{tabular}[c]{@{}l@{}}Error Rate/Spambase\end{tabular} &        \\
		Our optimal result (Local model, no noise, 1 peer)                & 0.100  \\
		High privacy, few peers($\epsilon$=0.1, 10 peers)				  & 0.157  \\
		Aggregated model				                                  & 0.157  \\
		Ensemble model				                                      & 0.157  \\
		Less noise, more peers($\epsilon$=1.0, 100 peers)				  & xxx  \\
		Noisy result ($\epsilon$=0.1, 50 peers)                           & xxx  \\
		
		
	\end{tabular}
	\caption{Table with baseline results from the Adult Dataset}
	\label{tab:baseline_class_results_spambase}
\end{table}

\begin{table}[h]
	\begin{tabular}{ll}
		\begin{tabular}[c]{@{}l@{}}Error Rate/Adult\end{tabular} &        \\
		%	Krempl,Decision tree with bagging\citep{}                                    & 0.196 \\	
		Our optimal result (Local model, e=1.0, 10 peer)                  & 0.157 \\
		High privacy, few peers($\epsilon$=0.1, 50 peers)				  & 0.163  \\
		Less noise, more peers($\epsilon$=1.0, 100 peers)				  & xxx  \\
		Noisy result ($\epsilon$=0.1, 50 peers)                           & xxx  \\
		Aggregated model														  & 0.185 \\
		Ensemble model													  &	0.165
	\end{tabular}
	\caption{Table with baseline results from the Adult Dataset}
	\label{tab:baseline_class_results_adult}
\end{table}

%testing range of epsilon to see expected behavior
\begin{figure}[H]
	\centering
	\includegraphics[width=\textwidth]{fig/spambase/eps2e-8-2e8,budg=eps,peers10,groups10,reg2e-2-data368-pubAll-spam-baseline-testset}
	\caption{$\epsilon = [10^{-3}, 10^{3}], \lambda = 2^{-4}$, 50 peers, 1 aggregation}
	\label{fig:epsilon_big_range}
\end{figure}

%testing range of regularization in various settings to validate presence of expected behavior
\begin{figure}[h!]
	\centering
	\begin{minipage}{.49\linewidth}
		\includegraphics[width=\linewidth]{fig/spambase/eps2e10,budg=eps,peers10,groups10,reg2e-8-2e3-data368-pubAll-spam-baseline-testset}
		\captionof{figure}{$\epsilon = 2^{10}, \lambda = [2^{-8}, 2^{3}]$, 10 peers, 1 aggregation}
		\label{fig:regularization_extremelyhighepsilon}
	\end{minipage}
	\hspace{.001\linewidth}
	\begin{minipage}{.49\linewidth}
		\includegraphics[width=\linewidth]{fig/spambase/eps0.1,budg=eps,peers10,groups10,reg2e-8-2e3-data368-pubAll-spam-baseline-testset}
		\captionof{figure}{$\epsilon = 0.1, \lambda = [2^{-8}, 2^{3}]$, 10 peers, 1 aggregation}
		\label{fig:regularization_normalepsilon}
	\end{minipage}
	\begin{minipage}{.49\linewidth}
		\includegraphics[width=\linewidth]{fig/spambase/eps0.01,budg=eps,peers10,groups10,reg2e-8-2e3-data368-pubAll-spam-baseline-testsetmean}
		\captionof{figure}{$\epsilon = 0.01, \lambda = [2^{-8}, 2^{3}]$, 10 peers, 1 aggregation}
		\label{fig:regularization_lowepsilon}
	\end{minipage}
\end{figure}

%figures showing the effect of data amounts in various combinations of models

\begin{figure}[h!]
	\centering
	\begin{minipage}{.49\linewidth}
		\includegraphics[width=\linewidth]{fig/spambase/eps0.1,budg=eps,peers10,groups10,reg2e-2-pubAll-spam-baseline-data10-360-testset-withoutlocalmodel}
		\captionof{figure}{$\epsilon = 0.1, \lambda = 2^{-2}$, 10 peers, 1 aggregations. Aggregated model only.}
		\label{fig:data_limit_test_withoutlocalmodel}
	\end{minipage}
	\hspace{.001\linewidth}
	\begin{minipage}{.49\linewidth}
		\includegraphics[width=\linewidth]{fig/spambase/eps0.1,budg=eps,peers10,groups10,reg2e-2-pubAll-spam-baseline-data10-360-testset-withlocalmodel}
		\captionof{figure}{$\epsilon = 0.1, \lambda = 2^{-2}$, 10 peers, 1 aggregation. Aggregated and local model.}
		\label{fig:data_limit_test_withlocalmodel}
	\end{minipage}
	\begin{minipage}{.49\linewidth}
		\includegraphics[width=\linewidth]{fig/spambase/eps0.1,budg=eps,peers10,groups10,reg2e-2-pubAll-spam-baseline-data10-360-testset-localmodelonly}
		\captionof{figure}{$\lambda = 2^{-2}$, 10 peers, local model only.}
		\label{fig:data_limit_test_localmodelonly}
	\end{minipage}
\end{figure}

%result of testing constant group size with ever larger number of peers
\todo[inline]{make Effect of peer numbers into a simple table row showing min/max instead}
\begin{figure}[H]
	\centering
	\includegraphics[width=\textwidth]{fig/adult/eps1.0,budg=eps,peers5-55,groups5,reg2e2-data500-pubAll-adult-groupbypeerverification-3-testsetmean}
	\caption{Effect of peer numbers. Group size: 50. Publishing: All. Data: 500}
	\label{fig:peer_range_constant_group}
\end{figure}


%figure showing the presence of variance among peers 
\todo[inline]{replace variance table with numbers from recent, properly CVed runs. ALSO, add std.dev. of std dev. :)}
\begin{table}[h]
	\centering
	\caption{Variance among peers, Adult}
	\label{table:peer_variance_adult}
	\begin{tabular}{lll}
		Model                  & Mean error & Peer std. dev. \\
		Local, no privacy      & 0,179       & 0.017          \\
		Aggregated, d. privacy & 0,185       & 0.006          \\       
	\end{tabular}
\end{table}      


%add - some result comparing difference between party and all publishing
%add - some result showing what happens when group sizes change - maybe combined with the above

%add - some result showing what happens when the amount of privacy budget used is changed - possibly considering all vs party also here


\cleardoublepage